<section id="nice" data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="font-size: 16px; color: black; padding: 0 10px; line-height: 1.6; word-spacing: 0px; letter-spacing: 0px; word-break: break-word; word-wrap: break-word; text-align: left; font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, 'PingFang SC', Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;"><p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black;">假定一个场景，我们需要一个前后端分离的应用，服务端API使用ASP.NET Core开发，前端有两套，一个是用于所有用户的客户端，另一个是给管理员使用的管理后台，使用asp.net core的hosting作为后端+前端的web服务器。应为默认情况下没有开启hosting的spa功能。针对这个，我们可能首先想到的是自定义一个中间件进行处理，当请求特定path，以及静态资源是，加载对应文件夹下的spa应用文件。其实微软早就为我们准备好了这个中间件。这个中间件在：<code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; color: #1e6bb8; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all;">Microsoft.AspNetCore.SpaServices.Extensions</code> 包中。</p>
<p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black;"><code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; color: #1e6bb8; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all;">dotnet new</code> 命令创建项目时，模板就已经内置了 angular和react的spa 模板。新建完成后，可以看到startup启动类中，多出来了两个东西：</p>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px;"><code class="hljs" style="overflow-x: auto; padding: 16px; color: #abb2bf; background: #282c34; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;"><span class="hljs-function" style="line-height: 26px;"><span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">public</span>&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">void</span>&nbsp;<span class="hljs-title" style="color: #61aeee; line-height: 26px;">ConfigureServices</span>(<span class="hljs-params" style="line-height: 26px;">IServiceCollection&nbsp;services</span>)</span><br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;services.AddSpaStaticFiles(configuration&nbsp;=&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;configuration.RootPath&nbsp;=&nbsp;<span class="hljs-string" style="color: #98c379; line-height: 26px;">"ClientApp/dist"</span>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br>&nbsp;&nbsp;&nbsp;&nbsp;...<br>}<br><br><span class="hljs-function" style="line-height: 26px;"><span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">public</span>&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">void</span>&nbsp;<span class="hljs-title" style="color: #61aeee; line-height: 26px;">Configure</span>(<span class="hljs-params" style="line-height: 26px;">IApplicationBuilder&nbsp;app,&nbsp;IWebHostEnvironment&nbsp;env</span>)</span><br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: #5c6370; font-style: italic; line-height: 26px;">//&nbsp;app.UseEndpoints&nbsp;...</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;app.UseSpa(spa&nbsp;=&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: #5c6370; font-style: italic; line-height: 26px;">//&nbsp;To&nbsp;learn&nbsp;more&nbsp;about&nbsp;options&nbsp;for&nbsp;serving&nbsp;an&nbsp;Angular&nbsp;SPA&nbsp;from&nbsp;ASP.NET&nbsp;Core,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: #5c6370; font-style: italic; line-height: 26px;">//&nbsp;see&nbsp;https://go.microsoft.com/fwlink/?linkid=864501</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spa.Options.SourcePath&nbsp;=&nbsp;<span class="hljs-string" style="color: #98c379; line-height: 26px;">"ClientApp"</span>;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">if</span>&nbsp;(env.IsDevelopment())<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spa.UseAngularCliServer(npmScript:&nbsp;<span class="hljs-string" style="color: #98c379; line-height: 26px;">"start"</span>);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br>}<br></code></pre>
<p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black;">直接运行，就可以启动应用程序，就可以看到spa应用程序已经正常工作了。</p>
<p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black;">默认的例子，只hosting 了一个spa应用，回到最初的问题，如果有两个或者多个需要处理呢。这就需要多次配置。</p>
<p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black;">我们来做下多spa的配置。</p>
<p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black;">为了整齐可读性高，我们使用IApplicationBuilder扩展的方式来配置多个SPA应用</p>
<h3 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 20px;"><span class="prefix" style="display: none;"></span><span class="content">新建SpaAPP01的扩展</span><span class="suffix" style="display: none;"></span></h3>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px;"><code class="hljs" style="overflow-x: auto; padding: 16px; color: #abb2bf; background: #282c34; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;"><span class="hljs-comment" style="color: #5c6370; font-style: italic; line-height: 26px;"><span class="hljs-doctag" style="color: #c678dd; line-height: 26px;">///</span>&nbsp;<span class="hljs-doctag" style="color: #c678dd; line-height: 26px;">&lt;summary&gt;</span></span><br><span class="hljs-comment" style="color: #5c6370; font-style: italic; line-height: 26px;"><span class="hljs-doctag" style="color: #c678dd; line-height: 26px;">///</span>&nbsp;SpaAPP01</span><br><span class="hljs-comment" style="color: #5c6370; font-style: italic; line-height: 26px;"><span class="hljs-doctag" style="color: #c678dd; line-height: 26px;">///</span>&nbsp;<span class="hljs-doctag" style="color: #c678dd; line-height: 26px;">&lt;/summary&gt;</span></span><br><span class="hljs-comment" style="color: #5c6370; font-style: italic; line-height: 26px;"><span class="hljs-doctag" style="color: #c678dd; line-height: 26px;">///</span>&nbsp;<span class="hljs-doctag" style="color: #c678dd; line-height: 26px;">&lt;returns&gt;</span><span class="hljs-doctag" style="color: #c678dd; line-height: 26px;">&lt;/returns&gt;</span></span><br><span class="hljs-function" style="line-height: 26px;"><span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">public</span>&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">static</span>&nbsp;IApplicationBuilder&nbsp;<span class="hljs-title" style="color: #61aeee; line-height: 26px;">UseSpaAPP01</span>(<span class="hljs-params" style="line-height: 26px;"><span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">this</span>&nbsp;IApplicationBuilder&nbsp;app,&nbsp;IConfiguration&nbsp;configuration</span>)</span><br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: #5c6370; font-style: italic; line-height: 26px;">//&nbsp;sourcePathPath&nbsp;是spa应用程序build后的文件目录</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">var</span>&nbsp;sourcePathPath&nbsp;=&nbsp;&nbsp;configuration[<span class="hljs-string" style="color: #98c379; line-height: 26px;">"Spa:SpaAPP01:RootPath"</span>];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: #5c6370; font-style: italic; line-height: 26px;">//&nbsp;routeString&nbsp;是路由模板，这里需要在spa应用打包时，所有引用的静态资源的地址前缀</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: #5c6370; font-style: italic; line-height: 26px;">//&nbsp;比如&nbsp;&nbsp;'./spa001/statics/index.js'&nbsp;&nbsp;可以参见html&nbsp;&lt;base&nbsp;href=''&gt;&nbsp;的作用</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">var</span>&nbsp;routeString&nbsp;=&nbsp;&nbsp;configuration[<span class="hljs-string" style="color: #98c379; line-height: 26px;">"Spa:SpaAPP01:RouteTemplate"</span>];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">var</span>&nbsp;fileOtp&nbsp;=&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">new</span>&nbsp;StaticFileOptions<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FileProvider&nbsp;=&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">new</span>&nbsp;PhysicalFileProvider(sourcePathPath)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;app.Map(routeString,&nbsp;appBuilder&nbsp;=&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;appBuilder.UseSpaStaticFiles(fileOtp);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;appBuilder.UseSpa(options&nbsp;=&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;options.Options.DefaultPageStaticFileOptions=fileOtp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br>&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">return</span>&nbsp;app;<br>}<br><br><span class="hljs-comment" style="color: #5c6370; font-style: italic; line-height: 26px;"><span class="hljs-doctag" style="color: #c678dd; line-height: 26px;">///</span>&nbsp;<span class="hljs-doctag" style="color: #c678dd; line-height: 26px;">&lt;summary&gt;</span></span><br><span class="hljs-comment" style="color: #5c6370; font-style: italic; line-height: 26px;"><span class="hljs-doctag" style="color: #c678dd; line-height: 26px;">///</span>&nbsp;SpaAPP02</span><br><span class="hljs-comment" style="color: #5c6370; font-style: italic; line-height: 26px;"><span class="hljs-doctag" style="color: #c678dd; line-height: 26px;">///</span>&nbsp;<span class="hljs-doctag" style="color: #c678dd; line-height: 26px;">&lt;/summary&gt;</span></span><br><span class="hljs-comment" style="color: #5c6370; font-style: italic; line-height: 26px;"><span class="hljs-doctag" style="color: #c678dd; line-height: 26px;">///</span>&nbsp;<span class="hljs-doctag" style="color: #c678dd; line-height: 26px;">&lt;returns&gt;</span><span class="hljs-doctag" style="color: #c678dd; line-height: 26px;">&lt;/returns&gt;</span></span><br><span class="hljs-function" style="line-height: 26px;"><span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">public</span>&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">static</span>&nbsp;IApplicationBuilder&nbsp;<span class="hljs-title" style="color: #61aeee; line-height: 26px;">UseSpaAPP02</span>(<span class="hljs-params" style="line-height: 26px;"><span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">this</span>&nbsp;IApplicationBuilder&nbsp;app,&nbsp;IConfiguration&nbsp;configuration</span>)</span><br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: #5c6370; font-style: italic; line-height: 26px;">//&nbsp;sourcePathPath&nbsp;是spa应用程序build后的文件目录</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">var</span>&nbsp;sourcePathPath&nbsp;=&nbsp;&nbsp;configuration[<span class="hljs-string" style="color: #98c379; line-height: 26px;">"Spa:SpaAPP02:RootPath"</span>];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: #5c6370; font-style: italic; line-height: 26px;">//&nbsp;routeString&nbsp;是路由模板，这里需要在spa应用打包时，所有引用的静态资源的地址前缀</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: #5c6370; font-style: italic; line-height: 26px;">//&nbsp;比如&nbsp;&nbsp;'./spa001/statics/index.js'&nbsp;&nbsp;可以参见html&nbsp;&lt;base&nbsp;href=''&gt;&nbsp;的作用</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">var</span>&nbsp;routeString&nbsp;=&nbsp;&nbsp;configuration[<span class="hljs-string" style="color: #98c379; line-height: 26px;">"Spa:SpaAPP02:RouteTemplate"</span>];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">var</span>&nbsp;fileOtp&nbsp;=&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">new</span>&nbsp;StaticFileOptions<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FileProvider&nbsp;=&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">new</span>&nbsp;PhysicalFileProvider(sourcePathPath)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;app.Map(routeString,&nbsp;appBuilder&nbsp;=&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;appBuilder.UseSpaStaticFiles(fileOtp);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;appBuilder.UseSpa(options&nbsp;=&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;options.Options.DefaultPageStaticFileOptions=fileOtp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br>&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">return</span>&nbsp;app;<br>}<br></code></pre>
<h3 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 20px;"><span class="prefix" style="display: none;"></span><span class="content">appsettign.json</span><span class="suffix" style="display: none;"></span></h3>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px;"><code class="hljs" style="overflow-x: auto; padding: 16px; color: #abb2bf; background: #282c34; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;">{<br><span class="hljs-attr" style="color: #d19a66; line-height: 26px;">"Spa"</span>:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr" style="color: #d19a66; line-height: 26px;">"SpaAPP01"</span>:&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr" style="color: #d19a66; line-height: 26px;">"RootPath"</span>:<span class="hljs-string" style="color: #98c379; line-height: 26px;">"E:\\spa001"</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr" style="color: #d19a66; line-height: 26px;">"RouteTemplate"</span>:<span class="hljs-string" style="color: #98c379; line-height: 26px;">"/spa-demo1"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr" style="color: #d19a66; line-height: 26px;">"SpaAPP02"</span>:{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr" style="color: #d19a66; line-height: 26px;">"RootPath"</span>:<span class="hljs-string" style="color: #98c379; line-height: 26px;">"E:\\spa002"</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr" style="color: #d19a66; line-height: 26px;">"RouteTemplate"</span>:<span class="hljs-string" style="color: #98c379; line-height: 26px;">"/spa-demo2"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;},<br>}<br></code></pre>
<h3 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 20px;"><span class="prefix" style="display: none;"></span><span class="content">startup</span><span class="suffix" style="display: none;"></span></h3>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px;"><code class="hljs" style="overflow-x: auto; padding: 16px; color: #abb2bf; background: #282c34; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;"><span class="hljs-function" style="line-height: 26px;"><span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">public</span>&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">void</span>&nbsp;<span class="hljs-title" style="color: #61aeee; line-height: 26px;">ConfigureServices</span>(<span class="hljs-params" style="line-height: 26px;">IServiceCollection&nbsp;services</span>)</span><br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;...<br>&nbsp;&nbsp;&nbsp;&nbsp;services.AddSpaStaticFiles();<br>&nbsp;&nbsp;&nbsp;&nbsp;...<br>}<br><br><span class="hljs-function" style="line-height: 26px;"><span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">public</span>&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">void</span>&nbsp;<span class="hljs-title" style="color: #61aeee; line-height: 26px;">Configure</span>(<span class="hljs-params" style="line-height: 26px;">IApplicationBuilder&nbsp;app,&nbsp;IWebHostEnvironment&nbsp;env</span>)</span><br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="color: #5c6370; font-style: italic; line-height: 26px;">//&nbsp;app.UseEndpoints&nbsp;...</span><br>&nbsp;&nbsp;&nbsp;&nbsp;app.UseSpaAPP01(configuration);<br>&nbsp;&nbsp;&nbsp;&nbsp;app.UseSpaAPP02(configuration);&nbsp;<br>}<br></code></pre>
<p data-tool="mdnice编辑器" style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black;">最后在<code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; color: #1e6bb8; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all;">E:\\spa001</code>和<code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; color: #1e6bb8; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all;">E:\\spa002</code>中放置build后的spa应用。启动asp.net core 应用程序，访问appsetting中设置好的对应RouteTemplate，就会打开对应的spa应用程序。spa中请求接口的路径也只需要使用接口的相对路径即可。spa引用的静态资源也会被加载。</p>
<blockquote class="multiquote-1" data-tool="mdnice编辑器" style="border: none; display: block; font-size: 0.9em; overflow: auto; overflow-scrolling: touch; border-left: 3px solid rgba(0, 0, 0, 0.4); background: rgba(0, 0, 0, 0.05); color: #6a737d; padding-top: 10px; padding-bottom: 10px; padding-left: 20px; padding-right: 10px; margin-bottom: 20px; margin-top: 20px;">
<p style="font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0px; color: black; line-height: 26px;">注意：当静态资源不存在时，会默认指向index.html。 如果发现某些非html 静态文件，返回成了html格式，那就是引入路径缺少了appsetting中配置的RouteTemplate前缀。</p>
</blockquote>
</section>